{%- liquid
  assign logo = section.settings.logo
  assign logo_width = section.settings.logo_width
  assign menu = section.settings.menu
-%}

{%- style -%}
  .header-{{ section.id }} {
    position: fixed;
    top: 0;
    width: 100%;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    z-index: 1000;
    border-bottom: 1px solid rgb(229, 231, 235);
    transition: all 0.3s ease;
  }

  .header-container-{{ section.id }} {
    max-width: 1280px;
    margin: 0 auto;
    padding: 0 1rem;
  }

  @media screen and (min-width: 640px) {
    .header-container-{{ section.id }} {
      padding: 0 1.5rem;
    }
  }

  @media screen and (min-width: 1024px) {
    .header-container-{{ section.id }} {
      padding: 0 2rem;
    }
  }

  .header-content-{{ section.id }} {
    display: flex;
    justify-content: space-between;
    align-items: center;
    height: 80px;
  }

  .header-logo-{{ section.id }} {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    text-decoration: none;
  }

  .header-logo-image-{{ section.id }} {
    height: {{ logo_width | default: 48 }}px;
    width: auto;
  }

  .header-nav-{{ section.id }} {
    display: none;
    gap: 2rem;
  }

  @media screen and (min-width: 768px) {
    .header-nav-{{ section.id }} {
      display: flex;
    }
  }

  .header-nav-link-{{ section.id }} {
    color: rgb(55, 65, 81);
    text-decoration: none;
    font-weight: 500;
    transition: color 0.2s ease;
    position: relative;
  }

  .header-nav-link-{{ section.id }}:hover {
    color: var(--color-primary);
  }

  .header-nav-link-{{ section.id }}::after {
    content: '';
    position: absolute;
    width: 0;
    height: 2px;
    bottom: -4px;
    left: 50%;
    background: var(--gradient-primary);
    transition: all 0.3s ease;
    transform: translateX(-50%);
  }

  .header-nav-link-{{ section.id }}:hover::after {
    width: 100%;
  }

  .header-cta-{{ section.id }} {
    display: none;
  }

  @media screen and (min-width: 768px) {
    .header-cta-{{ section.id }} {
      display: block;
    }
  }

  .header-cta-button-{{ section.id }} {
    background: var(--gradient-primary);
    color: white;
    padding: 0.5rem 1.5rem;
    border-radius: 0.5rem;
    text-decoration: none;
    font-weight: 600;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    border: none;
    cursor: pointer;
  }

  .header-cta-button-{{ section.id }}:hover {
    background: var(--gradient-primary-hover);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(255, 107, 53, 0.3);
  }

  .header-mobile-toggle-{{ section.id }} {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0.5rem;
    background: transparent;
    border: none;
    color: rgb(55, 65, 81);
    cursor: pointer;
    transition: color 0.2s ease;
  }

  @media screen and (min-width: 768px) {
    .header-mobile-toggle-{{ section.id }} {
      display: none;
    }
  }

  .header-mobile-toggle-{{ section.id }}:hover {
    color: var(--color-primary);
  }

  .header-mobile-menu-{{ section.id }} {
    display: none;
    background: white;
    border-top: 1px solid rgb(229, 231, 235);
    padding: 1rem 0;
  }

  .header-mobile-menu-{{ section.id }}.active {
    display: block;
  }

  @media screen and (min-width: 768px) {
    .header-mobile-menu-{{ section.id }} {
      display: none !important;
    }
  }

  .header-mobile-nav-{{ section.id }} {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .header-mobile-nav-link-{{ section.id }} {
    color: rgb(55, 65, 81);
    text-decoration: none;
    font-weight: 500;
    padding: 0.5rem 0;
    transition: color 0.2s ease;
    text-align: left;
    background: none;
    border: none;
    font-family: inherit;
    font-size: inherit;
    cursor: pointer;
  }

  .header-mobile-nav-link-{{ section.id }}:hover {
    color: var(--color-primary);
  }

  .header-mobile-cta-{{ section.id }} {
    margin-top: 1rem;
  }

  .header-mobile-cta-button-{{ section.id }} {
    background: var(--gradient-primary);
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 0.5rem;
    text-decoration: none;
    font-weight: 600;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    width: fit-content;
    border: none;
    cursor: pointer;
  }

  .header-mobile-cta-button-{{ section.id }}:hover {
    background: var(--gradient-primary-hover);
  }

  /* Cart icon styles */
  .header-cart-{{ section.id }} {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0.5rem;
    color: rgb(55, 65, 81);
    text-decoration: none;
    transition: color 0.2s ease;
    margin-right: 1rem;
  }

  .header-cart-{{ section.id }}:hover {
    color: var(--color-primary);
  }

  .header-cart-count-{{ section.id }} {
    position: absolute;
    top: 0;
    right: 0;
    background: var(--color-primary);
    color: white;
    font-size: 0.75rem;
    font-weight: 600;
    min-width: 18px;
    height: 18px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transform: translate(25%, -25%);
  }

  @media screen and (max-width: 767px) {
    .header-cart-{{ section.id }} {
      margin-right: 0.5rem;
    }
  }
{%- endstyle -%}

<header class="header-{{ section.id }}" role="banner">
  <div class="header-container-{{ section.id }}">
    <div class="header-content-{{ section.id }}">
      <!-- Logo -->
      <a href="{{ routes.root_url }}" class="header-logo-{{ section.id }}">
        {%- if logo != blank -%}
          {{ logo | image_url: width: logo_width | image_tag: loading: 'lazy', class: 'header-logo-image-' | append: section.id, alt: shop.name }}
        {%- else -%}
          <img 
            src="https://customer-assets.emergentagent.com/job_webdesign-hub-3/artifacts/wlvl18ct_Apexmediadesign_logo%20%281%29.png" 
            alt="{{ shop.name }}"
            class="header-logo-image-{{ section.id }}"
            loading="lazy"
          >
        {%- endif -%}
      </a>

      <!-- Desktop Navigation -->
      <nav class="header-nav-{{ section.id }}" role="navigation">
        {%- for link in linklists[menu].links -%}
          <a href="{{ link.url }}" class="header-nav-link-{{ section.id }}">
            {{ link.title }}
          </a>
        {%- endfor -%}
      </nav>

      <!-- Desktop Actions -->
      <div style="display: flex; align-items: center;">
        <!-- Cart Icon -->
        <a href="{{ routes.cart_url }}" class="header-cart-{{ section.id }}">
          <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17M17 13v4a2 2 0 01-2 2H9a2 2 0 01-2-2v-4m8 0V9a2 2 0 00-2-2H9a2 2 0 00-2 2v4.01"/>
          </svg>
          {%- if cart.item_count > 0 -%}
            <span class="header-cart-count-{{ section.id }}">{{ cart.item_count }}</span>
          {%- endif -%}
        </a>

        <!-- CTA Button -->
        {%- if section.settings.cta_text != blank -%}
          <div class="header-cta-{{ section.id }}">
            <a href="{{ section.settings.cta_url | default: '#contact' }}" class="header-cta-button-{{ section.id }}">
              {{ section.settings.cta_text }}
            </a>
          </div>
        {%- endif -%}

        <!-- Mobile Menu Toggle -->
        <button 
          class="header-mobile-toggle-{{ section.id }}" 
          type="button"
          onclick="toggleMobileMenu{{ section.id }}()"
          aria-label="Toggle mobile menu"
        >
          <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" id="menu-icon-{{ section.id }}">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
          <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" id="close-icon-{{ section.id }}" style="display: none;">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div class="header-mobile-menu-{{ section.id }}" id="mobile-menu-{{ section.id }}">
      <nav class="header-mobile-nav-{{ section.id }}" role="navigation">
        {%- for link in linklists[menu].links -%}
          <a href="{{ link.url }}" class="header-mobile-nav-link-{{ section.id }}" onclick="closeMobileMenu{{ section.id }}()">
            {{ link.title }}
          </a>
        {%- endfor -%}
        
        {%- if section.settings.cta_text != blank -%}
          <div class="header-mobile-cta-{{ section.id }}">
            <a href="{{ section.settings.cta_url | default: '#contact' }}" class="header-mobile-cta-button-{{ section.id }}" onclick="closeMobileMenu{{ section.id }}()">
              {{ section.settings.cta_text }}
            </a>
          </div>
        {%- endif -%}
      </nav>
    </div>
  </div>
</header>

<script>
  function toggleMobileMenu{{ section.id }}() {
    const mobileMenu = document.getElementById('mobile-menu-{{ section.id }}');
    const menuIcon = document.getElementById('menu-icon-{{ section.id }}');
    const closeIcon = document.getElementById('close-icon-{{ section.id }}');
    
    if (mobileMenu.classList.contains('active')) {
      mobileMenu.classList.remove('active');
      menuIcon.style.display = 'block';
      closeIcon.style.display = 'none';
    } else {
      mobileMenu.classList.add('active');
      menuIcon.style.display = 'none';
      closeIcon.style.display = 'block';
    }
  }
  
  function closeMobileMenu{{ section.id }}() {
    const mobileMenu = document.getElementById('mobile-menu-{{ section.id }}');
    const menuIcon = document.getElementById('menu-icon-{{ section.id }}');
    const closeIcon = document.getElementById('close-icon-{{ section.id }}');
    
    mobileMenu.classList.remove('active');
    menuIcon.style.display = 'block';
    closeIcon.style.display = 'none';
  }

  // Smooth scrolling for anchor links
  document.addEventListener('DOMContentLoaded', function() {
    const links = document.querySelectorAll('.header-nav-link-{{ section.id }}, .header-mobile-nav-link-{{ section.id }}');
    
    links.forEach(link => {
      if (link.getAttribute('href').startsWith('#')) {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const targetId = this.getAttribute('href').substring(1);
          const targetElement = document.getElementById(targetId);
          
          if (targetElement) {
            targetElement.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
          
          closeMobileMenu{{ section.id }}();
        });
      }
    });
  });
</script>

{% schema %}
{
  "name": "Apex Header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 32,
      "max": 200,
      "step": 4,
      "unit": "px",
      "label": "Logo width",
      "default": 48
    },
    {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "Menu"
    },
    {
      "type": "text",
      "id": "cta_text",
      "default": "Get Started",
      "label": "CTA button text"
    },
    {
      "type": "url",
      "id": "cta_url",
      "label": "CTA button link"
    }
  ]
}
{% endschema %}